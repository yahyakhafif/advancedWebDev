// backend/scripts/seedData.js
const mongoose = require('mongoose');
const dotenv = require('dotenv');
const User = require('../models/User');
const Style = require('../models/Style');
const path = require('path');
dotenv.config({ path: path.resolve(__dirname, '../.env') });
// Load env vars
dotenv.config();

// Connect to database
mongoose.connect(process.env.MONGO_URI, {
    useNewUrlParser: true,
    useUnifiedTopology: true
}).then(() => console.log('MongoDB Connected'))
    .catch(err => {
        console.error(`Error: ${err.message}`);
        process.exit(1);
    });

// Sample architectural styles with well-defined time periods
const styles = [
    {
        name: 'Gothic',
        period: '12th-16th Century',
        description: 'Gothic architecture is a European style that emerged in the 12th century featuring pointed arches, ribbed vaults, flying buttresses, and large stained glass windows. It represented a move towards greater height and light in religious buildings.',
        characteristics: ['Pointed arches', 'Ribbed vaults', 'Flying buttresses', 'Stained glass windows'],
        mainFeatures: ['Tall spires', 'Rose windows', 'Gargoyles'],
        imageUrl: 'https://i.pinimg.com/474x/1f/0e/f1/1f0ef1ae38ce6414e7f306d8a0e39143.jpg'
    },
    {
        name: 'Early Renaissance',
        period: '15th Century',
        description: 'Early Renaissance architecture marked the transition from Gothic to Renaissance styles, featuring more classical elements while still retaining some medieval characteristics.',
        characteristics: ['Classical orders', 'Symmetry', 'Proportion', 'Columns'],
        mainFeatures: ['Round arches', 'Domes', 'Classical details'],
        imageUrl: 'https://nuitalian.org/wp-content/uploads/2021/04/il-duomo.jpg?w=683'
    },
    {
        name: 'High Renaissance',
        period: '16th Century',
        description: 'High Renaissance architecture represents the peak of Renaissance ideals, with perfect harmony, proportion, and a complete return to classical principles.',
        characteristics: ['Perfect proportion', 'Mathematical harmony', 'Classical purity', 'Symmetrical plans'],
        mainFeatures: ['Grand domes', 'Classical facades', 'Monumental scale'],
        imageUrl: 'https://www.thespruce.com/thmb/Y8tZGMk_8bfssbUPkpOgy1GHegQ=/1500x0/filters:no_upscale():max_bytes(150000):strip_icc()/GettyImages-1210659789-e0c4b070626140a4af0f6016ff24b0ba.jpg'
    },
    {
        name: 'Baroque',
        period: '17th-18th Century',
        description: 'Baroque architecture is characterized by dramatic effects, grandeur, and theatrical flourishes. It uses exaggerated motion and clear, easily interpreted detail to produce drama, tension, exuberance, and grandeur.',
        characteristics: ['Dramatic use of light', 'Curved forms', 'Rich decoration', 'Grand scale'],
        mainFeatures: ['Oval shapes', 'Sculptural decoration', 'Trompe l\'oeil', 'Painted ceilings'],
        imageUrl: 'https://lp-seotool.s3.us-west-2.amazonaws.com/task_attachments/jlwxenCQZvzmHPGmN1mFEmv2hLNn28lY1615828628.jpg'
    },
    {
        name: 'Rococo',
        period: '18th Century',
        description: 'Rococo is a style characterized by lightness, elegance, and an exuberant use of curving natural forms in ornamentation. The style is marked by asymmetry, a pastel color scheme, and delicate, intimate scale.',
        characteristics: ['Asymmetry', 'Light colors', 'Curved lines', 'Ornate decoration'],
        mainFeatures: ['Shell motifs', 'Scrollwork', 'Intimate spaces', 'Floral designs'],
        imageUrl: 'https://sacredwindows.com/wp-content/uploads/2025/01/Wieskirche_Gemeinde_Steingaden_Ortsteil_Wies-3_OPT.jpg'
    },
    {
        name: 'Neoclassical',
        period: '18th-19th Century',
        description: 'Neoclassical architecture is characterized by grandeur of scale, simplicity of geometric forms, Greek and Roman details, dramatic use of columns, and a preference for blank walls. The style emerged from the desire to return to the perceived "purity" of the arts of ancient Rome and Greece.',
        characteristics: ['Symmetry', 'Classical elements', 'Monumental scale', 'Simplicity'],
        mainFeatures: ['Columns', 'Pediments', 'Domes', 'White color palette'],
        imageUrl: 'https://media.architecturaldigest.com/photos/6463e603797fd51ebe89c81a/3:2/w_5040,h_3360,c_limit/GettyImages-200493349-001.jpg'
    },
    {
        name: 'Romanticism',
        period: '19th Century',
        description: 'Romantic architecture emphasized emotion, individualism, and the glorification of nature and the past, particularly the medieval era.',
        characteristics: ['Gothic Revival elements', 'Picturesque quality', 'Emotional impact', 'Irregular forms'],
        mainFeatures: ['Towers', 'Turrets', 'Ornate details', 'Natural settings'],
        imageUrl: 'https://qph.cf2.quoracdn.net/main-qimg-346025c3d00d84b32ec81fb4a03b5691.webp'
    },
    {
        name: 'Victorian',
        period: '19th Century',
        description: 'Victorian architecture encompasses various styles that emerged during the Victorian era, characterized by ornate details, elaborate decoration, and eclectic mixing of historical influences.',
        characteristics: ['Ornate decoration', 'Asymmetrical shapes', 'Textured wall surfaces', 'Steep roofs'],
        mainFeatures: ['Bay windows', 'Towers', 'Stained glass', 'Decorative woodwork'],
        imageUrl: 'https://www.thespruce.com/thmb/U3fqGimgYSZgmh1cDVelP967Spk=/1500x0/filters:no_upscale():max_bytes(150000):strip_icc()/GettyImages-1085155108-ba49162c7af84762a6fc801bb147cf19.jpg'
    },
    {
        name: 'Art Nouveau',
        period: '1890-1910',
        description: 'Art Nouveau is characterized by its use of a long, sinuous, organic line and was employed most often in architecture, interior design, jewelry and glass design, posters, and illustration. It was a deliberate attempt to create a new style, free of the imitative historicism that dominated much of 19th-century art and design.',
        characteristics: ['Organic forms', 'Curved lines', 'Nature motifs', 'Asymmetry'],
        mainFeatures: ['Whiplash curves', 'Plant-like embellishments', 'Stained glass', 'Wrought iron'],
        imageUrl: 'https://www.sttinfo.fi/data/images/00758/df3f1402-d0ce-4034-8e33-a21d599a8813.jpg'
    },
    {
        name: 'Art Deco',
        period: '1920s-1930s',
        description: 'Art Deco is characterized by bold, geometric patterns and vibrant colors. It represented luxury, glamour, exuberance, and faith in social and technological progress.',
        characteristics: ['Bold geometric shapes', 'Vibrant colors', 'Symmetrical patterns', 'Streamlined forms'],
        mainFeatures: ['Zigzags', 'Sunburst motifs', 'Stepped designs', 'Chrome detailing'],
        imageUrl: 'https://cdn.vox-cdn.com/thumbor/PeknjDGhrfpTftH_xQHg8XcUw4Y=/0x0:2000x1333/1200x900/filters:focal(840x507:1160x827):no_upscale()/cdn.vox-cdn.com/uploads/chorus_image/image/62562653/151010_07_43_22_IMG_7726.55.jpg'
    },
    {
        name: 'Bauhaus',
        period: '1919-1933',
        description: 'Bauhaus architecture is characterized by its focus on functionality, simplicity, and rational, geometric forms. It shuns decoration and celebrates the materials used - particularly glass, steel and concrete.',
        characteristics: ['Minimalist', 'Functional', 'Geometric', 'No ornamentation'],
        mainFeatures: ['Flat roofs', 'Glass curtain walls', 'Steel frame construction', 'Primary colors'],
        imageUrl: 'https://static.dezeen.com/uploads/2016/08/tel-aviv-bauhaus-roundup_dezeen_936_2.jpg'
    },
    {
        name: 'International Style',
        period: '1920s-1960s',
        description: 'The International Style is characterized by a radical simplification of form, a rejection of ornament, and the adoption of glass, steel, and concrete as preferred materials.',
        characteristics: ['Rectilinear forms', 'Light, taut plane surfaces', 'Open interior spaces', 'Minimalism'],
        mainFeatures: ['Ribbon windows', 'Flat roofs', 'Pilotis', 'Curtain walls'],
        imageUrl: 'https://cdn.britannica.com/00/191400-050-268C088A/International-Style-architecture-Esplanade-Apartments-Ludwig-Mies.jpg'
    },
    {
        name: 'Mid-Century Modern',
        period: '1940s-1960s',
        description: 'Mid-Century Modern architecture features clean lines, gentle organic curves, and a mix of different materials. It emphasizes bringing the outdoors in with large windows and open spaces.',
        characteristics: ['Clean lines', 'Organic curves', 'Integration with nature', 'Functionality'],
        mainFeatures: ['Large windows', 'Open floor plans', 'Multiple levels', 'Indoor-outdoor living'],
        imageUrl: 'https://edwardgeorgelondon.com/wp-content/uploads/2024/10/Sun-drenched-mid-century-modern-home-exterior-with-mustard-terracotta-and-sage-facade-expansive-windows-and-minimalist-landscaping.webp'
    },
    {
        name: 'Brutalism',
        period: '1950s-1970s',
        description: 'Brutalist architecture is characterized by rigid, blocky, and massive structures made from concrete. The style emphasizes raw materials and structural elements over decorative design.',
        characteristics: ['Raw concrete', 'Massive forms', 'Geometric shapes', 'Textured surfaces'],
        mainFeatures: ['Exposed concrete', 'Monolithic appearance', 'Bold forms', 'Repetitive patterns'],
        imageUrl: 'https://www.parcmonceauwestport.com/wp-content/uploads/2019/08/habitat-67.jpg'
    },
    {
        name: 'Postmodernism',
        period: '1970s-1990s',
        description: 'Postmodern architecture is characterized by a playful and eclectic mix of classical and modern elements. It rejects the austerity and formality of modernism in favor of diverse aesthetics.',
        characteristics: ['Playful forms', 'Historical references', 'Color', 'Ornamentation'],
        mainFeatures: ['Contradictory elements', 'Asymmetry', 'Humor', 'Complexity'],
        imageUrl: 'https://parametric-architecture.com/wp-content/uploads/2024/08/Dancing-House-.webp'
    },
    {
        name: 'Deconstructivism',
        period: '1980s-Present',
        description: 'Deconstructivist architecture is characterized by fragmentation, non-linear design, and the manipulation of surface structures. It challenges traditional architectural values of harmony, unity, and stability.',
        characteristics: ['Fragmentation', 'Distortion', 'Asymmetry', 'Complexity'],
        mainFeatures: ['Angular forms', 'Disjointed surfaces', 'Non-rectilinear shapes', 'Controlled chaos'],
        imageUrl: 'https://blog.architizer.com/wp-content/uploads/deconstructivism.jpeg'
    }
];

// Create a test user
const createTestUser = async () => {
    try {
        await User.deleteMany({});

        const user = await User.create({
            name: 'Test User',
            email: 'test@example.com',
            password: 'password123'
        });

        console.log(`Test user created with ID: ${user._id}`);
        return user;
    } catch (error) {
        console.error('Error creating test user:', error);
        process.exit(1);
    }
};

// Seed the styles
const seedStyles = async (userId) => {
    try {
        await Style.deleteMany({});

        const stylesWithCreator = styles.map(style => ({
            ...style,
            createdBy: userId
        }));

        const created = await Style.insertMany(stylesWithCreator);

        console.log(`${created.length} architectural styles created`);
        return created;
    } catch (error) {
        console.error('Error seeding styles:', error);
        process.exit(1);
    }
};

// Add some favorites
const addFavorites = async (userId, styles) => {
    try {
        // Select 19th Century styles for the favorites (to show clear time period preference)
        const nineteenthCenturyStyles = styles.filter(
            style => style.period.includes('19th Century')
        );

        // Also add Art Nouveau which is close to 19th century
        const artNouveau = styles.find(style => style.name === 'Art Nouveau');

        const favoriteIds = [
            ...nineteenthCenturyStyles.map(style => style._id),
            artNouveau._id
        ];

        // Update user with favorites
        await User.findByIdAndUpdate(userId, {
            favorites: favoriteIds
        });

        console.log(`Added ${favoriteIds.length} favorites to the test user`);
        console.log('Favorites: ' + nineteenthCenturyStyles.map(s => s.name).join(', ') + ', Art Nouveau');
    } catch (error) {
        console.error('Error adding favorites:', error);
        process.exit(1);
    }
};

// Run the seeding process
const seed = async () => {
    try {
        const user = await createTestUser();
        const createdStyles = await seedStyles(user._id);
        await addFavorites(user._id, createdStyles);

        console.log('Seeding completed successfully');
        process.exit(0);
    } catch (error) {
        console.error('Seeding failed:', error);
        process.exit(1);
    }
};

// Execute seeding
seed();